<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#iris_menu" aria-controls="iris_menu" aria-expanded="false" aria-label="MENU">
  <span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse float-right" id="iris_menu">
  <ul class="navbar-nav ml-auto nowrap">
    <% if policy(:dashboard).index? %>
      <% if ["admin","superadmin"].include?(current_user.role) %>

        <li class="nav-item d-none d-lg-block">
          <div class="dropdown">
            <%= active_link_to t('controller.dashboard.index.link_name'), "javascript:;", active: :exclusive, class: "nav-link dropdown-toggle pl-0 pr-0", data: {toggle: 'dropdown'} %>
            <div class="dropdown-menu dropdown-menu-right menu-top">
              <%= link_to t('controller.dashboard.index.link_name'), dashboard_path(params: {role: current_user.role}), class: "dropdown-item" %>
              <%= link_to t('controller.dashboard.index.billing_team_link_name'), dashboard_path(params: {role: "billing_team"}), class: "dropdown-item" %>
              <%= link_to t('controller.dashboard.index.cp_admin_link_name'), dashboard_path(params: {role: "cp_admin"}), class: "dropdown-item" %>
            </div>
          </div>
        </li>
      <% else %>
        <li class="nav-item">
          <%= active_link_to t('controller.dashboard.index.link_name'), dashboard_path, active: :exclusive, class: "nav-link pl-0 pr-0" %>
        </li>
      <% end %>
    <% end %>

    <% if policy([:admin, Project]).index? %>
      <li class="nav-item">
        <%= active_link_to t('controller.projects.index.link_name'), admin_projects_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <% end %>

    <% if policy([:admin, ProjectUnit]).index? %>
      <li class="nav-item">
        <%= active_link_to t('controller.project_units.index.link_name'), admin_project_units_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <% end %>
    <% unless current_user.role?(:channel_partner) %>
      <% if policy([:admin, User]).index? %>
        <li class="nav-item">
          <%= active_link_to t('controller.users.index.link_name'), admin_users_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
        </li>
      <% end %>
    <% end %>
    <% if policy([:admin, Lead]).index? %>
      <li class="nav-item">
        <%= active_link_to t('controller.leads.index.link_name'), admin_leads_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <% end %>
    <% if false # policy([:admin, CpLeadActivity]).index? %>
      <li class="nav-item">
        <%= active_link_to t('controller.cp_lead_activities.index.link_name'), admin_cp_lead_activities_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <% end %>

    <% if policy([:admin, BookingDetail]).index? %>
      <li class="nav-item">
        <%= active_link_to t('controller.booking_details.index.link_name'), admin_booking_details_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <% end %>

    <!--
    <%# if policy(:custom).inventory? %>
      <li class="nav-item">
        <%#= active_link_to t('controller.inventory.index.link_name'), custom_inventory_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <%# end %>
    -->

    <% if policy([:admin, Receipt]).index? %>
      <li class="nav-item">
        <%= active_link_to t('controller.receipts.index.link_name'), admin_receipts_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <% end %>

    <% if policy([:admin, Invoice]).index? %>
      <li class="nav-item">
        <%= active_link_to t('controller.invoices.index.link_name'), admin_invoices_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
      </li>
    <% end %>

    <% if policy([:admin, ChannelPartner]).index? %>
      <%= active_link_to t('controller.channel_partners.index.link_name'), channel_partners_path, active: :inclusive, class: "nav-link pl-0 pr-0" %>
    <% end %>

    <% if current_user.role == 'channel_partner' %>
      <% channel_partner = current_user.associated_channel_partner %>
      <li class="nav-item d-none d-lg-block">
        <div class="dropdown">
          <%= active_link_to t('global.channel_partner_application'), "javascript:;", class: "nav-link dropdown-toggle pl-0 pr-0", data: {toggle: 'dropdown'} %>
          <div class="dropdown-menu dropdown-menu-right menu-top">
              <% if Admin::ChannelPartnerPolicy.new(current_user, channel_partner).edit? %>
                <%= link_to t('helpers.edit.link_name', model: ChannelPartner.model_name.human), edit_channel_partner_path(channel_partner), class: 'modal-remote-form-link dropdown-item' %>
              <% end %>
              <% if policy([ current_user_role_group, Asset.new(assetable: channel_partner)]).index? %>
                <%= link_to t('controller.assets.index.link_name'), assetables_path(assetable_type: channel_partner.class.model_name.i18n_key.to_s, assetable_id: channel_partner.id), class: 'modal-remote-form-link dropdown-item' %>
              <% end %>
          </div>
        </div>
      </li>
    <% end %>

    <%= render 'layouts/navbar/custom_links' %>

    <li class="nav-item user-dropdown dropdown">
      <img src="<%= asset_path 'user-alt-black.svg' %>" alt="User Info">
      <a class="nav-link dropdown-toggle display-inline mx-0 px-0" href="javascript:;" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <%= t('welcome', name: current_user.first_name ) %>
      </a>
      <div class="dropdown-menu user-menu-top" aria-labelledby="navbarDropdown">
        <%= link_to t('controller.users.profile.link_name', role: User.human_attribute_name("role.#{current_user.role}")), edit_admin_user_path(current_user), class: "dropdown-item modal-remote-form-link" %>
        <%= link_to t('controller.users.change_password.link_name'), update_password_admin_user_path(current_user), class: "dropdown-item modal-remote-form-link" %>
        <%= link_to t('sign_out', scope: "devise"), destroy_session_path(current_user), class: "dropdown-item", method: :delete %>
      </div>
    </li>
  </ul>
</div>
