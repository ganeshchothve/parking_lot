<% if policy(:dashboard).index? %>
  <li class="nav-item">
    <%= active_link_to "Dashboard", dashboard_path, active: :exclusive, class: "nav-link" %>
  </li>
<% end %>

<% if Buyer::ProjectUnitPolicy.new(current_user, ProjectUnit.new(user: current_user, status: "available")).hold? %>
  <li class="nav-item">
    <%= active_link_to "Apartment Selector", new_search_path, active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% if policy([:buyer, Receipt.new(user: current_user)]).direct? %>
  <li class="nav-item">
    <%= active_link_to "Make #{t('global.receipt')}", new_buyer_receipt_path, active: :inclusive, class: 'nav-link modal-remote-form-link' %>
  </li>
<% end %>

<% if Buyer::UserRequestPolicy.new(current_user, UserRequest).index? %>
  <li class="nav-item">
    <%= active_link_to t('global.user_requests'), buyer_user_requests_path(@user, request_type: "all"), active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% if UserKycPolicy.new(current_user, UserKyc).index? %>
  <li class="nav-item">
    <%= active_link_to t('global.user_kycs'), user_user_kycs_path, active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% if policy([:buyer, Receipt]).index? %>
  <li class="nav-item">
    <%= active_link_to t('global.receipts'), buyer_receipts_path, active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% links = [] %>

<% if CustomPolicy.custom_methods.present? %>
  <% CustomPolicy.custom_methods.each do |method| %>
    <% if policy(:custom).send("#{method}?") %>
        <% links << {method: method.to_s.titleize, link: eval("custom_#{method}_path")} %>
      </li>
    <% end %>
  <% end %>
<% end %>

<% if links.present? %>
  <li class="nav-item d-none d-lg-block">
    <div class="dropdown">
      <%= link_to t('global.custom'), "javascript:;", class: "nav-link dropdown-toggle", data: { toggle: "dropdown" } %>
      <div class="dropdown-menu dropdown-menu-right">
        <% links.each do |link| %>
          <%= link_to link[:method], link[:link], class: "dropdown-item" %>
        <% end %>
      </div>
    </div>
  </li>
<% end %>

<li class="nav-item d-none d-lg-block" style="margin-top:-5px;">
  <div class="dropdown">
    <a href="javascript:;" class="nav-link dropdown-toggle" data-toggle="dropdown">
      <%= icon "far", "user-circle", class: "text-muted fa-2x" %>
    </a>
    <div class="dropdown-menu dropdown-menu-right">
      <%= link_to "Profile", edit_admin_user_path(current_user), class: "dropdown-item modal-remote-form-link" %>
      <%= link_to "Change Password", update_password_user_path(current_user), class: "dropdown-item modal-remote-form-link" %>
      <%= link_to "Sign out", destroy_session_path(current_user), class: "dropdown-item", method: :delete %>
    </div>
  </div>
</li>

<% if links.present? %>
  <% links.each do |link| %>
    <li class="nav-item d-lg-none">
      <%= link_to link[:method], link[:link], class: "nav-link" %>
    </li>
  <% end %>
<% end %>

<li class="nav-item d-lg-none">
  <%= link_to "Profile", edit_admin_user_path(current_user), class: "nav-link modal-remote-form-link" %>
</li>

<hr/>

<li class="nav-item d-lg-none">
  <%= link_to "Change Password", update_password_user_path(current_user), class: "nav-link modal-remote-form-link" %>
</li>

<%= bottom_navigation('d-lg-none') %>

<li class="nav-item d-lg-none">
  <%= link_to "Sign out", destroy_session_path(current_user), class: "nav-link", method: :delete %>
</li>

<hr/>

<li class='nav-item d-lg-none'>
  <%= link_to 'Powered by Amura', 'https://www.amuratech.com', class: 'small nav-link', target: "_blank" %>
  <div class="d-md-none mt-3"></div>
</li>
