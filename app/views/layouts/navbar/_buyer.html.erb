<div class="collapse navbar-collapse float-right" id="iris_menu">
<ul class="navbar-nav ml-auto">
<% if policy(:dashboard).index? %>
  <li class="nav-item">
    <%= active_link_to "Dashboard", dashboard_path, active: :exclusive, class: "nav-link" %>
  </li>
<% end %>

<% if policy([:buyer, ProjectUnit.new(user: current_user, status: "available")]).hold? %>
  <li class="nav-item">
    <%= active_link_to "Apartment Selector", new_search_path, active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% if policy([:buyer, Receipt.new(user: current_user)]).direct? %>
  <li class="nav-item">
    <%= active_link_to "Make #{t('global.receipt')}", new_buyer_receipt_path, active: :inclusive, class: 'nav-link modal-remote-form-link' %>
  </li>
<% end %>

<% if policy([:buyer, UserRequest]).index? %>
  <li class="nav-item">
    <%= active_link_to t('global.user_requests'), buyer_user_requests_path(@user, request_type: "all"), active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% if policy([:buyer, BookingDetail]).index? %>
  <li class="nav-item">
    <%= active_link_to t('global.booking_details'), buyer_booking_details_path, active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% if policy([:buyer, Receipt]).index? %>
  <li class="nav-item">
    <%= active_link_to t('global.receipts'), buyer_receipts_path, active: :inclusive, class: "nav-link" %>
  </li>
<% end %>

<% links = [] %>

<% if CustomPolicy.custom_methods.present? %>
  <% CustomPolicy.custom_methods.each do |method| %>
    <% if policy(:custom).send("#{method}?") %>
        <% links << { method: method.to_s.titleize, link: eval("custom_#{method}_path"), name: t("#{method}.link_name")} %>
      </li>
    <% end %>
  <% end %>
<% end %>


<% if links.present? %>
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Special Features
    </a>
    <div class="dropdown-menu menu-top" aria-labelledby="navbarDropdown">
      <% links.each do |link| %>
        <%= link_to link[:name], link[:link], class: "dropdown-item" %>
      <% end %>
    </div>
  </li>
<% end %>

<li class="nav-item d-none d-lg-block" style="margin-top:-5px;">
  <div class="dropdown">
    <a href="javascript:;" class="nav-link dropdown-toggle" data-toggle="dropdown">
      <%= icon "far", "user-circle", class: "text-muted fa-2x" %>
    </a>
    <div class="dropdown-menu dropdown-menu-right">
      <%= link_to ('Profile ( ' + t("users.role.#{current_user.role}") + ' )'), edit_buyer_user_path(current_user), class: "dropdown-item modal-remote-form-link" %>
      <%= link_to "Change Password", update_password_buyer_user_path(current_user), class: "dropdown-item modal-remote-form-link" %>
      <%= link_to "Sign out", destroy_session_path(current_user), class: "dropdown-item", method: :delete %>
    </div>
  </div>
</li>
</ul>
</div>
