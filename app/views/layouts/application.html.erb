<!DOCTYPE html>
<html>
  <head>
    <title><%= current_project.name %> | <%= current_client.name %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag 'application', media: 'all' %>
    <%= javascript_include_tag 'application' %>

    <script src="https://js.pusher.com/4.1/pusher.min.js"></script>
    <%= javascript_tag do %>
      if(typeof App === "undefined"){
        App = {};
      }
      App.client = <%= raw current_client.to_json(only: [:name, :_id, :preferred_login]) %>;
      App.project = <%= raw current_project.to_json(only: [:name, :_id]) %>;
      <% if user_signed_in? %>
        App.current_user = <%= raw current_user.to_json %>;
        App.current_user.name = App.current_user.first_name + " " + App.current_user.last_name;
      <% end %>
      <% if Rails.env.development? || Rails.env.staging? %>
        Pusher.logToConsole = true;
      <% end %>
    <% end %>
    <script src='//trkr.scdn1.secure.raxcdn.com/t/<%= current_client.selldo_client_id %>.js'></script>
  </head>
  <% if !current_client.background_image.present? %>
  <body class="full-bg" style="background-image: url('<%= current_client.background_image.url %>');">
  <% else %>
  <body>
  <% end %>
    <div class="container-fluid">
      <nav id="top_navigation" class="navbar navbar-expand-lg fixed-top navbar navbar-light bg-white border-bottom">
        <a class="navbar-brand" href="<%= root_path %>" title="<%= current_project.name %> | <%= current_client.name %>">
          <img src="<%= asset_path current_client.logo.url %>" class="img-responsive d-none d-sm-block">
          <img src="<%= asset_path current_client.mobile_logo.url %>" class="img-responsive d-sm-none">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle main navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-navbar">
          <ul class="navbar-nav ml-auto mt-2">
            <% if current_client.enable_channel_partners? %>
            <li class="nav-item">
              <%= link_to "Register as Channel Partner", new_channel_partner_path, data:{event_category: 'Section', event_action: 'Click', event_name: 'Register Channel Partner'}, class: "mr-2 btn btn-secondary" %>
            </li>
            <% end %>
            <li class="nav-item">
              <%= link_to "Register Now", register_path, data:{event_category: 'Section', event_action: 'Click', event_name: 'Sign Up'}, class: "btn btn-primary" %>
            </li>
          </ul>
        </div>
      </nav>
      <%= render "layouts/navbar_footer" %>
      <% if notice %>
      <p class="alert alert-success notice"><%= notice %></p>
      <% end %>
      <% if alert %>
      <p class="alert alert-danger"><%= alert %></p>
      <% end %>
      <div class="body-padding"></div>
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-9">
            <div class="card">
              <div class="card-body">
                <%= yield %>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="body-padding"></div>
    </div>
    <% if current_client.ga_code.present? %>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', '<%= current_client.ga_code %>', 'auto');
      ga('require', 'ecommerce', 'ecommerce.js');
      ga('require', 'displayfeatures');
      ga('require', 'ec');
    </script>
    <% end %>
    <% if current_client.gtm_tag.present? %>
    <%= current_client.gtm_tag.html_safe %>
    <% end %>
  </body>
</html>
