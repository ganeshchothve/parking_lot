<%= form_for @account, url: url, remote: true, html: {class: 'modal-remote-form validate-form', "data-resource-type": global_labels['accounts'], "data-type": "json"} do |f| %>
  <div class="modal fade right fixed-header-footer" role="dialog" id="modal-remote-form-inner">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><%= @account.new_record? ? "New" : "Edit" %> <%= "#{global_labels['account']}" %></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <%= f.label :name, class: 'label-required' %>
            <%= f.text_field :name, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("name")) %>
          </div>
          <div class="form-group">
            <%= f.label :account_number, class: 'label-required' %>
            <%= f.text_field :account_number, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("account_number")) %>
          </div>
          <% case @account._type %>
          <% when 'Account::RazorpayPayment' %>
            <div class="form-group">
              <%= f.label :key, class: 'label-required' %>
              <%= f.text_field :key, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("key")) %>
            </div>
            <div class="form-group">
              <%= f.label :secret, class: 'label-required' %>
              <%= f.text_field :secret, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("secret")) %>
            </div>
          <% when 'Account::CcAvenuePayment' %>
            <div class="form-group">
              <%= f.label :merchant_id, class: 'label-required' %>
              <%= f.text_field :merchant_id, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("merchant_id")) %>
            </div>
            <div class="form-group">
              <%= f.label :access_code, class: 'label-required' %>
              <%= f.text_field :access_code, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("access_code")) %>
            </div>
            <div class="form-group">
              <%= f.label :working_key, class: 'label-required' %>
              <%= f.text_field :working_key, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("working_key")) %>
            </div>
          <% end %>
          <div class="form-group">
            <%= f.label :default, class: 'control-label' %>
            <%= f.check_box :by_default, disabled: (!(policy([:admin, @account]).editable_field?("by_default"))) %>
          </div>
        </div>
        <div class="modal-footer">
          <%= f.submit "Save", class: "btn btn-primary" %>
        </div>
      </div>
    </div>
  </div>
<% end %>
<%= javascript_tag do %>
$(document).ready(function(){
  FormInitializer.init($("#account_form"));
});
<% end %>
