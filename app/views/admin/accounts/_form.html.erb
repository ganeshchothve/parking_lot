<%= form_for @account, url: url, remote: true, html: { class: 'modal-remote-form validate-form', data: { 'resource-type': Account.model_name.human(count: 1), type: :json } } do |f| %>
  <div class="modal fade right fixed-header-footer" data-bs-backdrop="static" data-bs-keyboard="false" role="dialog" id="modal-remote-form-inner">
    <div class="modal-dialog modal-xl" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="title">
            <%= t("controller.accounts.#{action_name}.header") %>
          </h3>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
          </button>
        </div>
        <div class="modal-body theme-form">
          <% if policy([:admin, @account]).editable_field?("name") %>
            <div class="mb-3">
              <%= f.label :name, class: 'label-required' %>
              <%= f.text_field :name, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("name")) %>
            </div>
          <% end %>
          <% if policy([:admin, @account]).editable_field?("account_number") %>
            <div class="mb-3">
              <%= f.label :account_number, class: 'label-required' %>
              <%= f.text_field :account_number, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("account_number")) %>
            </div>
          <% end %>
          <% if policy([:admin, @account]).editable_field?("sub_account_number") %>
            <div class="mb-3">
              <%= f.label :sub_account_number %>
              <%= f.text_field :sub_account_number, autofocus: true, class: "form-control", disabled: !(policy([:admin, @account]).editable_field?("sub_account_number")) %>
            </div>
          <% end %>
          <% case @account._type %>
          <% when 'Account::RazorpayPayment' %>
            <% if policy([:admin, @account]).editable_field?("key") %>
              <div class="mb-3">
                <%= f.label :key, class: 'label-required' %>
                <%= f.text_field :key, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("key")) %>
              </div>
            <% end %>
            <% if policy([:admin, @account]).editable_field?("secret") %>
              <div class="mb-3">
                <%= f.label :secret, class: 'label-required' %>
                <%= f.text_field :secret, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("secret")) %>
              </div>
            <% end %>
          <% when 'Account::CcAvenuePayment' %>
            <% if policy([:admin, @account]).editable_field?("merchant_id") %>
              <div class="mb-3">
                <%= f.label :merchant_id, class: 'label-required' %>
                <%= f.text_field :merchant_id, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("merchant_id")) %>
              </div>
            <% end %>
            <% if policy([:admin, @account]).editable_field?("access_code") %>
              <div class="mb-3">
                <%= f.label :access_code, class: 'label-required' %>
                <%= f.text_field :access_code, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("access_code")) %>
              </div>
            <% end %>
            <% if policy([:admin, @account]).editable_field?("working_key") %>
              <div class="mb-3">
                <%= f.label :working_key, class: 'label-required' %>
                <%= f.text_field :working_key, autofocus: true, class: "form-control", required: 'required', disabled: !(policy([:admin, @account]).editable_field?("working_key")) %>
              </div>
            <% end %>
          <% end %>
          <% if policy([:admin, @account]).editable_field?("by_default") %>
            <div class="mb-3">
              <%= f.label :by_default, class: 'control-label' %>
              <%= f.check_box :by_default, disabled: (!(policy([:admin, @account]).editable_field?("by_default"))), style: "width:20px;height:20px;" %>
            </div>
          <% end %>
        </div>
        <div class="modal-footer text-end">
          <%= f.submit class: "btn btn-primary" %>
        </div>
      </div>
    </div>
  </div>
<% end %>
<%= javascript_tag do %>
$(document).ready(function(){
  FormInitializer.init($("#account_form"));
});
<% end %>
