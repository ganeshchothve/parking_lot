<table class='table my-customer-table responsive-tbl caption-top rounded mt-3 mb-0'>
  <thead class="th-default">
    <thead>
      <tr class="bg-primary white">
        <th><%= t('mongoid.attributes.workflow.stage') %></th>
      <th><%= t('mongoid.attributes.workflow.entity_type') %></th>
      <th><%= t('mongoid.attributes.workflow/pipeline.name') %></th>
      <th><%= t('mongoid.attributes.workflow/pipeline.stage') %></th>
      <th><%= t('mongoid.attributes.workflow/pipeline.reason') %></th>
      <th><%= t('mongoid.attributes.workflow.actions') %></th>
      <th class="text-right wd-22"></th>
      </tr>
    </thead>
  </thead>
  <tbody>
    <% workflows.each do |workflow| %>
      <% if workflow.pipelines.present? %>
        <tr>
          <td rowspan="<%= workflow.pipelines.count %>" data-title=<%= t('mongoid.attributes.workflow.stage') %>>
            <%= workflow.stage %>
          </td>
          <td><%= workflow.pipelines.first.entity_type %></td>
          <td><%= workflow.pipelines.first.pipeline_id %></td>
          <td><%= workflow.pipelines.first.pipeline_stage_id %></td>
          <td><%= workflow.pipelines.first.lead_closed_reason.presence || '-' %></td>
          <td class="action-btn">
            <div class="dropdown show text-right">
            <a class="btn table-dropdown-btn black-clr" href="javascript:;" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-ellipsis-v fill-theme" aria-hidden="true"></i></a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">
              <%= link_to t('helpers.edit.link_name', model: workflow.model_name.human), edit_admin_workflow_path(workflow), class: 'dropdown-item', data:{event_category: 'Section', event_action: 'Click', event_name: 'Edit Workflow'} %>
            </div>
            </div>
          </td>
        </tr>
        <% if workflow.pipelines.length > 1 %>
          <% workflow&.pipelines&.slice(1, workflow.pipelines.length)&.to_a&.each do |pipeline| %>
            <tr>
              <td><%= pipeline&.entity_type %></td>
              <td><%= pipeline&.pipeline_id %></td>
              <td><%= pipeline&.pipeline_stage_id %></td>
              <td><%= pipeline&.lead_closed_reason.presence || '-' %></td>
              <td class="action-btn">
                <div class="dropdown show text-right">
                  <a class="btn table-dropdown-btn black-clr" href="javascript:;" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-ellipsis-v fill-theme" aria-hidden="true"></i></a>
                  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">
                    <%= link_to t('helpers.edit.link_name', model: workflow.model_name.human), edit_admin_workflow_path(workflow), class: 'dropdown-item', data:{event_category: 'Section', event_action: 'Click', event_name: 'Edit Workflow'} %>
                  </div>
                </div>
              </td>
            </tr>
          <% end %>
        <% end %>
       <% end %> 
    <% end %>
  </tbody>
</table>

<div class="col-lg-12 py-3 bg-white mb-2 px-2">
  <div class="row">
    <div class="col-lg-6">
      <p class="table-entry mb-0 ps-2 pt-2"><%= page_entries_info workflows %></p>
    </div>
    <div class="col-lg-6 table-pagination">
      <%= will_paginate workflows, list_classes: %w(pagination justify-content-end) %>
    </div>
  </div>
</div>
