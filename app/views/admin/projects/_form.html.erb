<%
  if project.persisted?
    _url = admin_project_path(project)
  else
    _url = admin_projects_path
  end
%>
<%= nested_form_for project, url: _url, remote: true, local: true, html: { novalidate: false, id: "project_form", class: "modal-remote-form validate-form", data: { 'resource-type': Project.model_name.human, type: :json } } do |f| %>
  <div class="modal fade right fixed-header-footer" role="dialog" id="modal-remote-form-inner">
    <div class="modal-dialog modal-xl" role="document">
      <div class="modal-content">
        <div class="modal-header bg-gradient-cd white">
          <h3 class="title">
            <%= t('helpers.edit.link_name', model: Project.model_name.human)%>
          </h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="white">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <nav>
            <div class="nav nav-tabs" role="tablist">
              <a class="nav-item nav-link active" data-toggle="tab" href="#nav-project-basic" role="tab">Basic Details</a>
              <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-specifications" role="tab">Specifications</a>
              <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-offers" role="tab">Offers</a>
              <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-pages" role="tab">Content Pages</a>
              <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-logos" role="tab">Images & Documents</a>
              <% if current_user.role?(:superadmin) %>
                <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-integrations" role="tab">Integrations</a>
                <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-bookings" role="tab">Bookings</a>
                <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-contacts" role="tab">Contacts & Notifications</a>
                <% if policy(ThirdPartyReference).editable_field?('reference_id') %>
                  <a class="nav-item nav-link" data-toggle="tab" href="#nav-project-crm-ids" role="tab">CRM IDs</a>
                <% end %>
              <% end %>
            </div>
          </nav>
        <div class="mt-3"></div>
          <div class="tab-content">
            <div class="tab-pane fade show active" id="nav-project-basic" role="tabpanel">
              <%= render 'admin/projects/basic', f: f, project: project %>
            </div>
            <div class="tab-pane fade" id="nav-project-specifications" role="tabpanel">
              <%= render 'admin/projects/specifications', f: f, project: project %>
            </div>
            <div class="tab-pane fade" id="nav-project-offers" role="tabpanel">
              <%= render 'admin/projects/offers', f: f, project: project %>
            </div>
            <div class="tab-pane fade" id="nav-project-pages" role="tabpanel">
                <%= render 'admin/projects/pages', f: f, project: project %>
              </div>
              <div class="tab-pane fade" id="nav-project-logos" role="tabpanel">
                <%= render 'admin/projects/logos', f: f, project: project %>
              </div>
            <% if current_user.role?(:superadmin) %>
              <div class="tab-pane fade" id="nav-project-bookings" role="tabpanel">
                <%= render 'admin/projects/bookings', f: f, project: project %>
              </div>
              <div class="tab-pane fade" id="nav-project-contacts" role="tabpanel">
                <%= render 'admin/projects/contacts', f: f, project: project %>
              </div>
              <div class="tab-pane fade" id="nav-project-integrations" role="tabpanel">
                <%= render 'admin/projects/integrations', f: f, project: project %>
              </div>
              <% if policy(ThirdPartyReference).editable_field?('reference_id') %>
                <div class="tab-pane fade" id="nav-project-crm-ids" role="tabpanel">
                  <%= render 'admin/projects/crm_ids', f: f, project: project %>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
        <div class="modal-footer">
          <%= f.submit "Save", class: 'btn btn-primary' %>
        </div>
      </div>
    </div>
  </div>
<% end %>
<%= javascript_tag do %>
  $(document).ready(function(){
    FormInitializer.init($("#project_form"));
  });
<% end %>
