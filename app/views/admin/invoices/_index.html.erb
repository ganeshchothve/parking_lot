<table class='table my-customer-table responsive-tbl caption-top rounded mt-3 mb-0'>
  <thead class="th-default">
    <thead>
      <tr class="bg-primary white">
        <th><%= t('mongoid.attributes.invoice.number') %></th>
        <th><%= t('mongoid.attributes.invoice.category') %></th>
        <th>Account Manager</th>
        <th><%= t('mongoid.attributes.invoice.incentive_resource') %> | Project</th>
        <!--<th><%#= IncentiveScheme.model_name.human %> Details</th> -->
        <th><%= t('mongoid.attributes.invoice.amount') %></th>
        <th><%= t('mongoid.attributes.invoice.status') %></th>
        <th class="text-right action"></th>
      </tr>
    </thead>
  </thead>
  <tbody>
    <% invoices.each do |invoice| %>
      <tr>
        <td><span class="col-title"><%= invoice.try(:number) %></span></td>
        <td><span class="col-title"><%= t("mongoid.attributes.incentive_scheme/categories.#{invoice.category}") %></span></td>
        <td><span class="col-title"><%# unless current_user.role?('channel_partner') %><%#= link_to_if policy([current_user_role_group, invoice.manager]).index?, invoice.manager_name, [:admin, invoice.manager], class: "theme-txt-color" %><%# end %><%= invoice.account_manager.try(:name) %></span></td>
        <td>
          <%= link_to invoice.invoiceable.name_in_invoice, [current_user_role_group, invoice.invoiceable], class: "theme-txt-color" %>
          <% if invoice.invoiceable_type != 'User' %>
            <div class='small d-inline-block'> <span class="mx-2">| </span>
              <span><%= invoice.project_name %></span>
            </div>
          <% end %>
        </td>
        <!--
        <td>
          <%#= link_to_if policy([current_user_role_group, IncentiveScheme]).index?, invoice.incentive_scheme.name.try(:titleize), [:admin, :invoices, {'remote-state': edit_admin_incentive_scheme_path(invoice.incentive_scheme)}] %>
          <div class='small'>
            <span><%#= Ladder.model_name.human %> - Stage <%#= invoice.ladder_stage %></span><br>
            <%# if adj = invoice.incentive_scheme.ladders.where(stage: invoice.ladder_stage).first.try(:payment_adjustment).presence %>
              <%# if adj.absolute_value.blank? && adj.formula.present? %>
                <span><%#= formula_to_human(adj.formula) %><span>
              <%# else %>
                <span><strong><%#= number_to_indian_currency(adj.absolute_value) %></strong></span>
              <%# end %>
            <%# end %>
          </div>
        </td>
        -->
        <td>
          <span class="col-title">
          <%= number_to_indian_currency(invoice.amount) %></span>
          <% if invoice.status.in?(%w(approved paid)) && invoice.net_amount.present? %>
            <div class='small row'>
              <span><%= t('mongoid.attributes.invoice.net_amount') %><%= invoice.project.gst_slab_applicable ? ' (included GST)' : '' %> :</span><span> <strong><%= number_to_indian_currency(invoice.net_amount) %></strong></span></span>
            </div>
          <% end %>
        </td>
        <td>
          <span class="col-title">
          <i class='fa fa-circle fa-xs status_<%= t("mongoid.attributes.invoice/status.#{invoice.status}").downcase %> me-2'></i><%= t("mongoid.attributes.invoice/status.#{invoice.status}") %></span>
         <% if invoice.rejected? %>
            <div class='small row'>
              <span class='break-word'>Reason:</span><span> <%= invoice.rejection_reason %></span></div>
            </div>
          <% end %>
          <% if deduction = invoice.incentive_deduction.presence %>
            <div class='small row'>
              <span class="col-6"><%= IncentiveDeduction.model_name.human %>:</span>
              <span class="col-6"> <strong><%= number_to_indian_currency(deduction.amount) %></strong> (<%= t("mongoid.attributes.incentive_deduction/status.#{deduction.status}") %>)</span></span>
            </div>
          <% end %>
        </td>
        <td>
          <div class="dropdown show text-right">
            <a class="btn table-dropdown-btn black-clr" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-ellipsis-v" aria-hidden="true"></i></a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">
              <%= render 'admin/invoices/links', invoice: invoice %>
              </div>
          </div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
