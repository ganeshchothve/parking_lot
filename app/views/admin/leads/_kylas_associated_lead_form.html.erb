<div class="h-100">
  <div class='fn-18 theme-txt-color mb-2'>
    <div class="card-body">
      <% 
        kylas_products = {}
        kylas_products['Deal Product'] = @deal_associated_products if @deal_associated_products.present?
        kylas_products['Other Products'] = (@kylas_products | @deal_associated_products) - (@kylas_products & @deal_associated_products) if @kylas_products.present?
      %>
      <div class="row theme-form">
        <%= f.hidden_field :kylas_deal_id, value: @lead.kylas_deal_id %>
        <div class="mb-3 col-lg-6">
          <%= f.label :kylas_product, class: 'label-required' %>
          <%= f.select :kylas_product_id, grouped_options_for_select(kylas_products), { include_blank: 'Select Kylas Product'}, autocomplete: 'off', class: 'selectize', required: true, disabled: !(policy([current_user_role_group, @lead]).editable_field?("project_id")) %>
        </div>

        <div class="mb-3 col-lg-6">
          <%= f.label :kylas_contact, class: 'label-required' %>
          <%= f.select :kylas_contact_id, options_for_select(@deal_associated_contacts), { include_blank: 'Select Kylas Contact'}, autocomplete: 'off', class: 'selectize', required: true %>
        </div>


        <div class="mb-3 col-lg-6">
          <%= f.label :first_name, class: 'label-required' %>
          <%= f.text_field :first_name, class: 'form-control', autofocus: true, required: true, readonly: true %>
        </div>

        <div class="mb-3 col-lg-6">
          <%= f.label :last_name, class: 'label-required' %>
          <%= f.text_field :last_name, class: 'form-control', autofocus: true, required: true, readonly: true %>
        </div>

        <div class="mb-3 col-lg-6">
          <%= f.label :email, class: 'label-required' %>
          <%= f.select :email, options_for_select([]), { include_blank: 'Select Kylas Email'}, autocomplete: 'off', class: 'selectize email_select', disabled: !(policy([current_user_role_group, @lead]).editable_field?("email")) %>
        </div>

        <div class="mb-3 col-lg-6">
          <%= f.label :phone, class: 'label-required' %>
          <%= f.select :phone, options_for_select([]),  { include_blank: 'Select Kylas Phone'}, autocomplete: 'off', class: 'selectize phone_select', disabled: !(policy([current_user_role_group, @lead]).editable_field?("phone")) %>
        </div>

        <% if (policy([current_user_role_group, @lead]).editable_field?("manager_id")) %>
        <div class="mb-3 col-lg-6">
          <%= f.label :manager_id %>
          <%= f.select :manager_id, options_from_collection_for_select(@cp_users.present? ? @cp_users : [], "id" , "name", ((@cp_users.first.id.to_s rescue nil))), {prompt: true }, class: 'selectize-remote', data: { url: admin_users_path, params: { fltrs: { role: ['channel_partner', 'cp_owner' ], user_status_in_company: 'active' } } }%>
        </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<div class="booking-flow-footer position-fixed w-100 bottom-0 start-0 p-2 py-3 bg-white border-top text-end">
  <a href="" class="btn btn-primary no-fill font-medium ms-2">Cancel</a>
  <%= f.submit "Next", class: 'btn btn-primary font-medium border-primary ms-2 w-auto d-inline-block text-white' %>
</div>