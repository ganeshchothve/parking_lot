<div class="modal fade right fixed-header-footer" role="dialog" id="modal-remote-form-inner">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header" >
        <h3 class="title">
          <%= t("helpers.#{action_name}.link_name", model: (params[:walkin] ? SiteVisit.model_name.human : Lead.model_name.human) ) %>
        </h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body theme-form">
        <nav>
          <div class="nav nav-tabs theme-tab" role="tablist">
            <a class="nav-item nav-link <%= @existing_lead ? '' : 'active' %>" data-bs-toggle="tab" href="javascript:;" data-bs-target="#nav-lead-new" role="tab"><%= t('controller.leads.create_new_lead.link_name', model: (params[:walkin] ? SiteVisit.model_name.human : Lead.model_name.human)) %></a>
            <a class="nav-item nav-link <%= @existing_lead ? 'active' : '' %>" data-bs-toggle="tab" href="javascript:;" data-bs-target="#nav-lead-existing" role="tab"><%= t('controller.leads.create_from_existing_lead.link_name') %></a>
          </div>
        </nav>
        <div class="mt-3"></div>
        <div class="tab-content theme-form">
          <div class="tab-pane fade <%= @existing_lead ? '' : 'show active' %>" id="nav-lead-new" role="tabpanel">
            <%= simple_form_for @lead, url: check_and_register_path, remote: true, local: true, html: { class: "modal-remote-form validate-form theme-form", id: 'add-new-lead-form', "data-resource-type": global_labels['lead'], "data-type": "json" } do |f| %>
              <%= render 'admin/leads/non_selldo_form_fields', f: f, lead: @lead %>
            <% end %>
          </div>
          <div class="tab-pane fade <%= @existing_lead ? 'show active' : '' %>" id="nav-lead-existing" role="tabpanel">
            <%= simple_form_for @lead, url: check_and_register_path, remote: true, local: true, html: { class: "modal-remote-form validate-form theme-form", id: 'add-existing-lead-form', "data-resource-type": global_labels['lead'], "data-type": "json" } do |f| %>
              <%= render 'admin/leads/non_selldo_lead_copy_form_fields', f: f, lead: @lead, existing_lead: @existing_lead %>
            <% end %>
          </div>
        </div>
      </div>
      <div class="modal-footer text-end">
        <%= submit_tag "Save", class: 'btn btn-primary', form: (@existing_lead ? 'add-existing-lead-form' : 'add-new-lead-form') %>
      </div>
    </div>
  </div>
</div>
<%= javascript_tag do %>
  $(document).ready(function(){
    FormInitializer.init($("#add-new-lead-form"));
    FormInitializer.init($("#add-existing-lead-form"));
    $('a[data-bs-toggle="tab"]').on('show.bs.tab', function (event) {
      var $tab = $(event.target);
      $(event.currentTarget).parents('.modal').find('.modal-footer input[type="submit"]').attr('form', $(event.currentTarget).parents('.modal').find($tab.data('bs-target')).find('form').attr('id'));
    });
  });
<% end %>
