<% project_unit = booking_detail.project_unit %>
<% if policy([:admin, Receipt.new(user: project_unit.user, project_unit: project_unit)]).new? %>
  <%= link_to "Add #{t('global.receipt')}", new_admin_user_project_unit_receipt_path(project_unit.user, project_unit_id: project_unit), class: 'dropdown-item modal-remote-form-link' %>
<% end %>

<% if policy([:admin, project_unit]).show? %>
  <%= link_to "View Details", admin_booking_detail_path(booking_detail), class: 'dropdown-item' %>
<% end %>
<% if project_unit.pending_booking_detail_scheme.present? && policy(project_unit.pending_booking_detail_scheme).edit? %>
  <%= link_to "Update scheme and discount", edit_admin_user_booking_detail_booking_detail_scheme_path(project_unit.user_id, project_unit.booking_detail, project_unit.pending_booking_detail_scheme.id), class: 'dropdown-item modal-remote-form-link' %>
<% elsif project_unit.booking_detail && policy(BookingDetailScheme.new(project_unit_id: project_unit.id)).new? %>
  <%= link_to "Update scheme and discount", new_admin_user_booking_detail_booking_detail_scheme_path(project_unit.user_id, project_unit.booking_detail), class: 'dropdown-item modal-remote-form-link' %>
<% end %>

<% if ProjectUnit.booking_stages.include?(booking_detail.status) %>
  <% if policy([:admin, Receipt ]).index? %>
    <%= link_to "View #{t('global.receipts')}", admin_user_booking_detail_receipts_path(booking_detail.user, booking_detail), class: 'dropdown-item' %>
  <% end %>
<% end %>

<% UserRequest.descendants.each do |klass| %>
  <% if policy([:admin, klass.new(user_id: project_unit.user_id, project_unit_id: project_unit.id)]).new? && !current_user.buyer? %>
      <%= link_to t("global.user_request_#{klass.model_name.element}"), new_admin_user_user_request_path(user_id: booking_detail.user_id, project_unit_id: project_unit.id, request_type: klass.model_name.element), class: "dropdown-item modal-remote-form-link" %>
  <% end %>
<% end %>