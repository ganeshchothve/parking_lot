<% if @user.errors.present? %>
  <div class="alert alert-danger">
    <ul>
      <% @user.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>
<%= form_for [:admin, @user], html: {class: "validate-form"} do |f| %>
<div class="form-group">
  <%= f.label :name, class: 'control-label label-required' %>
  <%= f.text_field :name, class: 'form-control', autofocus: true, required: 'required', disabled: (policy(@user).editable_field?("name") ? false : true) %>
</div>
<div class="form-group">
  <%= f.label :email, class: 'control-label label-required' %>
  <%= f.email_field :email, class: 'form-control', required: 'required', disabled: (policy(@user).editable_field?("email") ? false : true) %>
</div>
<div class="form-group">
  <%= f.label :phone, class: 'control-label label-required' %><br/>
  <%= f.text_field :phone, class: 'form-control phone', required: 'required', disabled: (policy(@user).editable_field?("phone") ? false : true) %>
</div>
<% if @user.role.blank? %>
  <div class="form-group">
    <%= f.label :role, class: 'control-label label-required' %>
    <%= f.select :role, User.available_roles.reject{|r| r[:id] == 'user'}.collect{|r| [r[:text], r[:id]] }, {prompt: true}, class: 'selectize', required: 'required', disabled: (policy(@user).editable_field?("role") ? false : true) %>
  </div>
<% else %>
  <%= f.hidden_field :role %>
<% end %>
<% if @user.role?('channel_partner') %>
  <div class="form-group">
    <%= f.label :rera_id, class: "control-label #{@user.role?('channel_partner') ? 'label-required' : ''}" %>
    <%= f.text_field :rera_id, class: 'form-control', required: @user.role?('channel_partner') ? true : false, disabled: (policy(@user).editable_field?("rera_id") ? false : true) %>
  </div>
  <div class="form-group">
    <%= f.label :location, class: "control-label #{@user.role?('channel_partner') ? 'label-required' : ''}" %>
    <%= f.text_field :location, class: 'form-control', required: @user.role?('channel_partner') ? true : false, disabled: (policy(@user).editable_field?("location") ? false : true) %>
  </div>
<% end %>
<%= f.submit "Save", class: 'btn btn-primary' %>
<% end %>
<%= javascript_tag do %>
$(document).ready(function(){
  FormInitializer.init($("#new_user"));
});
<% end %>
