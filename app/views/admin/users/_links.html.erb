<% if policy([:admin, user]).block_lead? %>
  <%= link_to t('controller.users.block_lead.link_name'), block_lead_admin_user_path(user),
  class: "dropdown-item modal-remote-form-link" %>
<% end %>

<% if policy([:admin, user]).unblock_lead? %>
  <%= link_to t('controller.users.unblock_lead.link_name'), unblock_lead_admin_user_path(user), method: :patch,
  class: "dropdown-item" %>
<% end %>

<%# if policy([:admin, Crm::Base.new()]).choose_crm? && Crm::Api.where(resource_class: 'User').present? %>
  <%#= link_to t('controller.crms.choose_crm.link_name'), choose_crm_admin_crm_base_index_path(resource_id: user.id, resource_class: user.class), class: "dropdown-item " %>
<%# end %>

<% if policy([:admin, user]).confirm_via_otp? %>
  <%= link_to t('controller.users.confirm_via_otp.link_name'), confirm_via_otp_admin_user_path(user.id), class: "dropdown-item modal-remote-form-link" %>
<% end %>
<% if policy([:admin, user]).confirm_user? %>
  <%
    if marketplace? && !user.role.in?(%w[cp_owner channel_partner])
      link_name = t('controller.users.invite_user.link_name')
    else
      link_name = t('controller.users.confirm_user.link_name')
    end
  %>
  <%= link_to link_name, confirm_user_admin_user_path(user), method: :patch, class: "dropdown-item" %>
<% end %>

<% if policy([:admin, user]).choose_template_for_print? %>
  <%= link_to t('controller.templates.choose_template_for_print.link_name'), choose_template_for_print_admin_custom_templates_path(subject_class: user.class.model_name.i18n_key.to_s, subject_class_id: user.id.to_s), class: 'dropdown-item modal-remote-form-link' %>
<% end %>

<% if policy([:admin, user]).print? %>
  <%= link_to t('controller.users.print.link_name'), print_admin_user_path(user.id), class: "dropdown-item", target: "_blank" %>
<% end %>

<% if policy([:admin, user]).show? && action_name != 'show' %>
  <%= link_to t('controller.users.show.link_name', role: User.human_attribute_name("role.#{user.role}")), admin_user_path(user), class: "dropdown-item" %>
<% end %>

<% if policy([:admin, user]).edit? %>
  <%= link_to t('controller.users.edit.link_name', role: User.human_attribute_name("role.#{user.role}")), edit_admin_user_path(user.id), class: "dropdown-item modal-remote-form-link" %>
<% end %>

<% if user.buyer? && policy([:admin, Lead]).index? %>
  <%= link_to t('controller.users.leads.link_name'), admin_user_leads_path(user.id), class: 'dropdown-item' %>
<% end %>

<% if policy([:admin, Note.new(notable: user)]).new? %>
  <%= link_to t('helpers.new.link_name', model: Note.model_name.human), new_notable_path(notable_type: user.class.model_name.i18n_key.to_s, notable_id: user.id), class: "dropdown-item modal-remote-form-link" %>
<% end %>

<% if !user.confirmed? && user.confirmation_token.present? && policy([:admin, user]).resend_confirmation_instructions? %>
  <%= link_to t('controller.users.resend_confirmation_instructions.link_name'), resend_confirmation_instructions_admin_user_path(user), class: "dropdown-item" %>
<% elsif policy([:admin, user]).resend_password_instructions? %>
  <%= link_to t('controller.users.resend_password_instructions.link_name'), resend_password_instructions_admin_user_path(user), class: "dropdown-item" %>
<% end %>

<% if policy([:admin, user]).update_password? %>
  <%= link_to t('controller.users.change_password.link_name'), update_password_admin_user_path(user), class: "dropdown-item modal-remote-form-link" %>
<% end %>

<%= render 'admin/invoices/invoiceable_links', resource: user %>

<% #if policy([:admin, user]).reactivate_account? %>
  <%#= link_to t('controller.users.reactivate_account.link_name'), reactivate_account_admin_user_path(user), method: :patch,
  class: "dropdown-item" %>
<% #end %>

<% if policy([:admin, user]).asset_create? %>
  <%= link_to Asset.model_name.human(count: 2), admin_user_path(user,'remote-state': assetables_path(assetable_type: user.class.model_name.i18n_key.to_s, assetable_id: user.id) ), class: "dropdown-item" %>
<% end %>

<% if policy([:admin, user]).change_state? %>
  <% user.aasm(:company).events(permitted: true).each do |event| %>
    <% if event.name == :inactive %>
      <%= link_to t("controller.users.change_state.links.#{user.user_status_in_company}_to_#{event.name}"), change_state_admin_user_path(user, {user: {user_status_in_company_event: event.name}}), method: :patch, class: 'dropdown-item', data:{event_category: 'Section', event_action: 'Click', event_name: t("controller.users.change_state.#{event.name}") } %>
    <% end %>
  <% end %>
<% end %>
