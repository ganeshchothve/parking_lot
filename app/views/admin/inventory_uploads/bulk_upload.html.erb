<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-12">
      <div class="card">
        <div class="card-body">
          <div class="row mb-3">
            <div class="col-md-6">
              <%= form_for [:admin, @bulk_upload_report] do |f| %>
                <%= f.hidden_field :uploaded_by_id, value: current_user.id %>
                <div class = 'form-group'>
                  <%= f.fields_for :asset, Asset.new do |p| %>
                    <%= p.hidden_field :asset_type %>
                    <%= p.file_field :file, class: 'btn pl-0 d-none', id: 'file-input', accept: '.csv' %>
                    <label for = "file-input" class = "db-small-btn light-blue bg-white fn-500 large-btn" id = "file-input-label">Upload Inventory</label>
                  <% end %>
                </div>
                <%= f.submit "Save", class: "d-none", id: "save" %>
              <% end %>
            </div>
            <div class="col-md-6 ">
              <div style = "text-align: right;" class = "d-none done">
                <%= link_to "Done", admin_bulk_upload_reports_path, class: 'btn btn-primary' %>
              </div>
            </div>
          </div>
        </div>
        <div class = "pl-5 pr-5 d-none progress-div" style="text-align: center;">
          <div class="progress">
            <div class="progress-bar progress-bar-striped active" role="progressbar"
            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%" id = "progress">
            0%
            </div>
          </div>
          <div class = "progress-div-text">
            <h2 class = "pt-2">Uploading ...</h2>
            <h3 class = "pt-2">Please do not refresh or press back button</h3>
          </div>
        </div>
      </div>
      <div class="card upload-messages d-none">
        <div class="card-body">
          <div id = "messages" class = "pl-4 pt-3"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<%= javascript_tag do %>
  $(document).ready(function(){
    FormInitializer.init($("#bulk_upload_report_form"));
    $("#file-input").change(function(){
      $("#save").click();
      $("#file-input").attr("disabled", "disabled");
      $("#file-input-label").addClass("d-none")
      $(".progress-div").removeClass("d-none")
      $(".upload-messages").removeClass("d-none")
    })
  });
<% end %>