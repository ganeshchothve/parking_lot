<%= render 'breadcrumbs', {user: @user, user_request: @user_request} %>
<div class="row">
  <div class="col-md-8 border border-left-0 border-top-0 border-bottom-0">
    <% if @user_request.errors.present? %>
    <div class="alert alert-danger">
      <ul>
        <% @user_request.errors.full_messages.each do |message| %>
        <li><%= message %></li>
        <% end %>
      </ul>
    </div>
    <% end %>
    <%= form_for [:user, @user_request], html: {class: 'validate-form'} do |f| %>
      <div class="form-group">
        <%= f.label :project_unit_id, class: 'control-label label-required' %>
        <%= f.select :project_unit_id, @user_request.user.project_units.collect{|x| [x.name, x.id] }, {prompt: true}, class: 'selectize', disabled: (policy(@user_request).editable_field?("project_unit_id") ? false : true), required: "required" %>
      </div>
      <div class="form-group">
        <%= f.label :comments, class: 'control-label label-required' %>
        <%= f.text_area :comments, autofocus: true, class: "form-control", required: 'required', disabled: (policy(@user_request).editable_field?("comments") ? false : true) %>
      </div>
      <% if policy(@user_request).editable_field?("status") %>
        <div class="form-group">
          <%= f.label :status, class: 'control-label label-required' %>
          <%= f.select :status, UserRequest.available_statuses.collect{|x| [x[:text], x[:id]] }, {prompt: true}, class: 'selectize', required: "required" %>
        </div>
      <% end %>
      <div class="form-group">
        <%= f.submit "Submit", class: 'btn btn-primary' %>
      </div>
    <% end %>
    <%= render "assets/index", assetable: @user_request %>
    <br/><br/><br/>
    <%= javascript_tag do %>
    $(document).ready(function(){
      FormInitializer.init($('.validate-form'));
    });
    <% end %>
  </div>
  <div class="col-md-4">
  </div>
</div>
