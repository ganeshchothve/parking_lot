<table class='table my-customer-table responsive-tbl'>
  <thead class="th-default">
    <% labels = t('mongoid.attributes.user_request').with_indifferent_access %>
      <thead>
        <tr class="bg-gradient-cd white">
          <th style="width:40%"><%= labels['details'] %></th>
          <th style="width:30%"><%= labels["request_details"] %></th>
          <th style="width:20%"><%= labels['status'] %></th>
          <th class="text-right">Actions</th>
        </tr>
      </thead>
  </thead>
  <tbody>
    <% user_requests.each do |user_request| %>
      <tr>
        <td data-title=<%= labels['details'] %> style="width:40%">
          <% if !current_user.buyer? && policy([:admin, user_request]).show? && !(params[:controller] == 'admin/user_requests' && params[:action] == 'show') %>
            <%= link_to "#{user_request.class.model_name.element.titleize} Request", admin_user_request_path(request_type: user_request.class.model_name.element, id: user_request.id) %>
          <% end %>
          <% if user_request.requestable_id.present? %>
            <div class="small text-muted" style="line-height:18px;">
              <%= t("user_requests.requestable_type.#{user_request.requestable_type}") %>: <%= user_request.requestable.try(:name) || '-' %>
            </div>
          <% end %>
          <% if user_request.is_a?(UserRequest::General) %>
            <% if ['superadmin', 'admin', 'crm'].include?(current_user.role) %>
              <div class="small text-muted" style="line-height:18px;">
                <%= t("user_requests.requestable_type.department")  %>: <%= user_request.department.try(:titleize) || '-' %>
              </div>
            <% end %>
            <% if ['superadmin', 'admin', 'crm'].include?(current_user.role) %>
              <div class="small text-muted" style="line-height:18px;">
                <%= t("user_requests.requestable_type.priority")  %>: <%= user_request.priority.try(:titleize) || '-' %>
              </div>
            <% end %>
            <% if ['superadmin', 'admin', 'crm'].include?(current_user.role) %>
              <div class="small text-muted" style="line-height:18px;">
                <%= t("user_requests.requestable_type.due_date")  %>: <%= user_request.due_date.try(:in_time_zone, current_user.time_zone).try(:strftime, '%d/%m/%Y') || '-' %>
              </div>
            <% end %>
          <% end %>
        </td>
        <td data-title= <%= t('mongoid.attributes.user_request.request_details') %> >
          <% if user_request.lead_id.present? %>
            <% if Admin::LeadPolicy.new(current_user, user_request.lead).show? %>
              <%= link_to user_request.lead.name, [current_user_role_group, user_request.lead] %>
            <% else %>
              <%= user_request.lead.name %>
            <% end %>
          <% else %>
            <% if Admin::UserPolicy.new(current_user, user_request.user).show? %>
              <%= link_to user_request.user.name, [current_user_role_group, user_request.user] %>
            <% else %>
              <%= user_request.user.name %>
            <% end %>
          <% end %>
          <% if user_request.project_id.present? %>
            <div class="small text-muted" style="line-height:18px;">
              <%= Project.model_name.human %> :
              <%= user_request.project_name %>
            </div>
          <% end %>
        </td>
        <td data-title=<%= labels['status'] %> >
          <%= t("mongoid.attributes.user_request/status.#{user_request.status}") %>
          <div class="text-muted small" style="line-height:18px;">
            <%= labels[:created_at] %>: <%= l(user_request.created_at.in_time_zone(current_user.time_zone)) %>
          </div>
          <% if user_request.resolved_at.present? %>
            <div class="text-muted small" style="line-height:18px;">
              <%= labels[:resolved_at] %>: <%= l(user_request.resolved_at.in_time_zone(current_user.time_zone)) %>
            </div>
          <% end %>
        </td>
        <td>
          <div class="dropdown show text-right">
          <a class="btn dropdown-toggle table-dropdown-btn black-clr" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span></span><span></span><span></span></a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">
              <%= render "#{current_user_role_group}/user_requests/links", user_request: user_request, links_name: '' %>
           </div>
        </div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 pt-2">
  <%= will_paginate user_requests, list_classes: %w(pagination justify-content-center) %>
</div>
