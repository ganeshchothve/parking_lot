<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-3 no-pd">
  <div class="box-card relative table-responsive" id="dashboard_project_wise_invoice_summary">
    <table class="table my-customer-table responsive-tbl mb-0">
      <thead class="th-default">
        <tr class="bg-primary white">
          <th rowspan='2' class='border-end bg-primary white'><%= Project.model_name.human %></th>
          <th colspan='3' class='text-center bg-primary white'>No. of <%= Invoice.model_name.human(count:2) %></th>
        </tr>
        <tr class="bg-primary white text-center">
          <th class="bg-primary white"><%= t('mongoid.attributes.invoice/status.pending_approval') %></th>
          <th class="bg-primary white"><%= t('mongoid.attributes.invoice/status.approved') %></th>
          <th class="bg-primary white"><%= t('mongoid.attributes.invoice/status.rejected') %></th>
        </tr>
      </thead>
      <tbody class='text-md-center'>
        <% @invoice_data.sort_by{|x| x[:project_name]}.group_by{|x| x[:project_name]}.each do |project_name, data| %>
          <tr>
            <td data-title='<%= Project.model_name.human %>' class='text-md-left'><%= project_name %></td>
            <td data-title='No. of <%= "#{t('mongoid.attributes.invoice/status.pending_approval')} #{Invoice.model_name.human(count:2)}" %>'>
              <%= data.find {|x| x[:status] == 'pending_approval'}.try(:[], :count) || 0 %>
            </td>
            <td data-title='No. of <%= "#{t('mongoid.attributes.invoice/status.approved')} #{Invoice.model_name.human(count:2)}" %>'>
              <%= data.find {|x| x[:status] == 'approved'}.try(:[], :count) || 0 %>
            </td>
            <td class='non-action-td' data-title='No. of <%= "#{t('mongoid.attributes.invoice/status.rejected')} #{Invoice.model_name.human(count:2)}" %>'>
              <%= data.find {|x| x[:status] == 'rejected'}.try(:[], :count) || 0 %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-4 no-pd">
  <div class="box-card relative table-responsive" id="dashboard_project_wise_invoice_summary">
    <table class="table my-customer-table responsive-tbl mb-0">
      <thead class="th-default">
        <tr class="bg-primary white">
          <th rowspan='2' class='th-border-right'><%= Project.model_name.human %></th>
          <th colspan='2' class='text-center'>Total <%= t('mongoid.attributes.invoice.amount') %></th>
        </tr>
        <tr class="bg-primary white text-center">
          <th><%= "#{t('mongoid.attributes.invoice/status.pending_approval')} (#{t('mongoid.attributes.invoice.amount')})" %></th>
          <th><%= "#{t('mongoid.attributes.invoice/status.approved')} (#{t('mongoid.attributes.invoice.net_amount')})" %></th>
        </tr>
      </thead>
      <tbody class='text-md-center'>
        <% @invoice_data.sort_by{|x| x[:project_name]}.group_by{|x| x[:project_name]}.each do |project_name, data| %>
          <tr>
            <td data-title='<%= Project.model_name.human %>' class='text-md-left'><%= project_name %></td>
            <td data-title='Total <%= "#{t('mongoid.attributes.invoice.amount')} (#{t('mongoid.attributes.invoice/status.pending_approval')})" %>'>
              <%= number_to_indian_currency(data.find {|x| x[:status] == 'pending_approval'}.try(:[], :amount) || 0) %>
            </td>
            <td class='non-action-td' data-title='Total <%= "#{t('mongoid.attributes.invoice.net_amount')} (#{t('mongoid.attributes.invoice/status.approved')})" %>'>
              <%= number_to_indian_currency(data.find {|x| x[:status] == 'approved'}.try(:[], :net_amount) || 0) %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
