<div class="col-lg-12 col-xs-12 col-md-12 col-sm-12 no-pd" id="apartment">
  <div class="box-card">
    <div class="box-header bg-gradient br-rd-tr-4">
      <h2><%= booking_detail.name %></h2>
      <% if defined?(with_actions) && with_actions == true %>
        <div class="dropdown show text-center float-right">
          <a class="btn dropdown-toggle table-dropdown-btn" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span></span><span></span><span></span></a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
              <%= render "#{current_user_role_group}/booking_details/links", booking_detail: booking_detail, link_name: 'Update Booking' %>
            </div>
        </div>
      <% end %>
    </div>
    <div class="box-content br-rd-bl-4 bg-white br-1 pt-0">
      <div class="row pd-box">
        <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 no-pd">
          <ul class="booking-apart-info">
            <% project_unit = booking_detail.project_unit %>
            <li><span>Name</span><p><%= booking_detail.name %></p></li>
            <li><span>Customer</span><p><%= link_to_if booking_detail.user, booking_detail.user_name, [current_user_role_group, booking_detail.user] %></p></li>
            <li><span>Tower</span><p><%= project_unit.project_tower.name %></p></li>
            <% unless params[:action] == 'quotation' %>
              <li><span>Tower</span><p><%= t("booking_details.status.#{booking_detail.status}") %></p></li>
            <% end %>
            <li><span>Beds/Bath</span><p><%= project_unit.unit_configuration.bedrooms %> / <%= project_unit.unit_configuration.bathrooms %></p></li>
            <li><span>Carpet</span><p><%= project_unit.carpet %> <%= current_client.area_unit %></p></li>
            <% if current_user.role?('superadmin') %>
              <li><span>Effective Rate</span><p><%= number_to_indian_currency(booking_detail.effective_rate) %></p></li>
              <li><span>Saleable</span><p><%= booking_detail.saleable %> <%= current_client.area_unit %></p></li>
              <li><span>Base Rate/ Floor Rise</span><p><%= number_to_indian_currency(booking_detail.base_rate)%> / <%= number_to_indian_currency(booking_detail.floor_rise) %></p></li>
            <% end %>
            <li><span>Agreement Price</span><p><%= number_to_indian_currency(booking_detail.calculate_agreement_price.round) %></p></li>
            <li><span>All Inclusive Price</span><p><%= number_to_indian_currency(booking_detail.calculate_all_inclusive_price.round) %></p></li>
            <li><span>Phase</span><p><%= project_unit.phase.try(:name) %></p></li>
          </ul>
        </div>
      </div>
      <% if current_client.external_api_integration? %>
      <div class="row pd-box">
        <% if booking_detail.sync_logs.present? %>
          <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 no-pd">
            <ul class="booking-apart-info">
              <li><span>Last Synced At:</span>
                <% if booking_detail.present? && booking_detail.sync_logs.present? %>
                  <p><%= booking_detail.sync_logs.desc(:created_at)[0].present? ? booking_detail.sync_logs.desc(:created_at)[0].updated_at.strftime("%d/%m/%Y %l:%M %p") : "-" %></p>
                <% else %>
                  <%= "Not synced" %>
                <% end %>
              </li>
              <li><span>Last Sync Log Status:</span>
                <% if booking_detail.present? && booking_detail.sync_logs.present? %>
                  <p><%= booking_detail.sync_logs.desc(:created_at)[0].status.present? ? booking_detail.sync_logs.desc(:created_at)[0].status : "-" %></p>
                <% else %>
                  <%= "Not synced" %>
                <% end %>
              </li>
          </div>
        <% end %>
      </div>
    <% end %>
    <% if %w[ hold swapped canceled ].exclude?(booking_detail.status)  %>
      <div class="row pd-box">
        <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 no-pd">
          <ul class="booking-apart-info">
            <li><span>Amount Paid</span><p><%= number_to_indian_currency(booking_detail.total_amount_paid) %></p><div class="small">* Considers processed <%= global_labels[:receipts] %> only</div></li>
            <li><span>Pending Balance</span><p><%= number_to_indian_currency(booking_detail.pending_balance({strict: true})) %></p></li>
          </ul>
        </div>
      </div>

      <div class="alert alert-primary">
        <ul>
          <li>You need to pay <%= number_to_indian_currency(booking_detail.project_unit.booking_price) %> to confirm the booking</li>
          <% unless current_client.cancellation_amount.zero? %>
            <li>Cancellation charges are <%= number_to_indian_currency(current_client.cancellation_amount) %></li>
          <% end %>
          <% if booking_detail.project_unit.auto_release_on %>
            <li>You have <%= (booking_detail.project_unit.auto_release_on - Date.today).to_i %> days (before <%= I18n.l(booking_detail.project_unit.auto_release_on) %>) remaining to confirm this booking. Please make a remaining payment of <%= number_to_indian_currency(booking_detail.pending_balance.round) %></li>
          <% end %>
        </ul>
      </div>
    <% end %>
    </div>
  </div>
</div>
