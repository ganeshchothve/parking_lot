<!-- TO-DO - Add sourcing manager directory and move this there -->
<div class="box-card relative table-responsive mb-5">
  <table class="table my-customer-table responsive-tbl mb-0">
    <thead class="th-default">
      <tr class="bg-primary white">
        <th><%= t("mongoid.attributes.user/role.cp") %></th>
        <% if current_client.enable_leads? %>
          <th><%= Lead.model_name.human(count: 2) %></th>
        <% end %>
        <th><%= t('mongoid.attributes.site_visit/status.scheduled') %><br> <%= SiteVisit.model_name.human(count: 2) %></th>
        <th><%= t('mongoid.attributes.site_visit/status.conducted') %><br> <%= SiteVisit.model_name.human(count: 2) %></th>
        <th><%= t('mongoid.attributes.site_visit/status.pending') %><br> <%= SiteVisit.model_name.human(count: 2) %></th>
        <th><%= t('mongoid.attributes.site_visit/approval_status.approved') %><br> <%= SiteVisit.model_name.human(count: 2) %></th>
        <th><%= t('mongoid.attributes.site_visit/approval_status.rejected') %><br> <%= SiteVisit.model_name.human(count: 2) %></th>
        <th><%= BookingDetail.model_name.human(count: 2) %></th>
        <th><%= t('mongoid.attributes.booking_detail.agreement_price') %></th>
      </tr>
    </thead>
    <tbody>
      <% @cps.each do |cp| %>
        <tr>
          <td data-title='Sourcing manager Name'><%= cp.name %></td>
          <% if current_client.enable_leads? %>
            <td data-title='<%= I18n.t("global.walkin.other") %>'><%= link_to @leads[cp.id] || 0, admin_leads_path(fltrs: {cp_manager_id: cp.id, created_at: params[:dates], project_ids: params[:project_ids]}) %></td>
          <% end %>
          <td data-title='<%= I18n.t("mongoid.attributes.site_visit/status.scheduled") + " " + SiteVisit.model_name.human(count: 2) %>'><%= link_to @site_visits.dig('scheduled', cp.id.to_s) || 0, admin_site_visits_path(fltrs: {status: 'scheduled', cp_manager_id: cp.id, scheduled_on: @dates, project_idss: params[:project_idss]}) %></td>
          <td data-title='<%= I18n.t("mongoid.attributes.site_visit/status.conducted") + " " + SiteVisit.model_name.human(count: 2) %>'><%= link_to @site_visits.dig('conducted', cp.id.to_s) || 0, admin_site_visits_path(fltrs: {status: 'conducted', cp_manager_id: cp.id, scheduled_on: @dates, project_idss: params[:project_idss]}) %></td>
          <td data-title='<%= I18n.t("mongoid.attributes.site_visit/approval_status.pending") + " " + SiteVisit.model_name.human(count: 2) %>'><%= link_to @site_visits.dig('pending', cp.id.to_s) || 0, admin_site_visits_path(fltrs: {approval_status: 'pending', cp_manager_id: cp.id, scheduled_on: @dates, project_idss: params[:project_idss]}) %></td>
          <td data-title='<%= I18n.t("mongoid.attributes.site_visit/approval_status.approved") + " " + SiteVisit.model_name.human(count: 2) %>'><%= link_to @site_visits.dig('approved', cp.id.to_s) || 0, admin_site_visits_path(fltrs: {approval_status: 'approved', cp_manager_id: cp.id, scheduled_on: @dates, project_idss: params[:project_idss]}) %></td>
          <td data-title='<%= I18n.t("mongoid.attributes.site_visit/approval_status.rejected") + " " + SiteVisit.model_name.human(count: 2) %>'><%= link_to @site_visits.dig('rejected', cp.id.to_s) || 0, admin_site_visits_path(fltrs: {approval_status: 'rejected', cp_manager_id: cp.id, scheduled_on: @dates, project_idss: params[:project_idss]}) %></td>
          <td data-title='Bookings'><%= link_to @bookings.dig(cp.id, :count) || 0, admin_booking_details_path(fltrs: {cp_manager_id: cp.id, created_at: @dates, project_idss: params[:project_idss]}) %></td>
          <td class='non-action-td' data-title='<%= I18n.t("mongoid.attributes.project_unit.agreement_price") %>'><%= number_to_inr(@bookings.dig(cp.id, :sales_revenue) || 0)%></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
