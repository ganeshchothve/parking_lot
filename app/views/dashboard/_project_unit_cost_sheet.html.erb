<div class="card">
  <div class="card-body">
    <div class="table-responsive">
      <% if defined?(search) && search.is_a?(Search) && policy(search).update_template?(::Template::CostSheetTemplate) %>
        <%= form_for project_unit, url: update_template_user_search_path(search), method: 'post', html: {class: 'validate-form', id: "cost_sheet_template_form"} do |f| %>
          <div class="input-group mb-3">
            <%= f.select :cost_sheet_template_id, ::Template::CostSheetTemplate.where(booking_portal_client_id: current_client.id).collect{|x| [x.name, x.id]}, {}, class: "form-control" %>
            <div class="input-group-append">
              <%= f.submit :Choose, class: "btn btn-primary" %>
            </div>
          </div>
        <% end %>
        <%= javascript_tag do %>
        $(document).ready(function(){
          FormInitializer.init($("#cost_sheet_template_form"));
        });
        <% end %>
      <% end %>
      <%= project_unit.cost_sheet_template.parsed_content(project_unit) %>
    </div>
  </div>
</div>
