<tr>
  <td data-title=<%= User.model_name.human %> >
    <% if policy([current_user_role_group, receipt.user]).show? %>
      <%= link_to receipt.user.name, [current_user_role_group, receipt.user] %>
    <% else %>
      <%= receipt.user.name %>
    <% end %>
    <div class="small">
      <%= t('mongoid.attributes.receipt.created_by')%>: <%= receipt.creator.name %><br/>
      <% if receipt.user.role?("user") && receipt.user.manager_id.present? && current_user.role != "channel_partner" %>
        <%= t('mongoid.attributes.user.manager_id') %>: <%= receipt.user.manager_name %><br/>
      <% end %>
    </div>
  </td>
  <td data-title=<%= t('mongoid.attributes.receipt.receipt_id') %> >
    <%= ["pending", 'clearance_pending'].include?(receipt.status) ?  t('global.not_generated') : receipt.receipt_id %>
    <div class="small muted">
      <div>
        <%= receipt.booking_detail.present? ? "#{BookingDetail.model_name.human}: #{receipt.booking_detail.name}" : 'Direct Payment' %>
      </div>
      <% if receipt.online? %>
        <div> <%= t('mongoid.attributes.receipt.payment_identifier')%> : <%= receipt.payment_identifier %></div>
        <div> <%= t('mongoid.attributes.receipt.processed_on')%>:<%= receipt.processed_on.present? ? l(receipt.processed_on) : "-" %></div>
      <% else %>
        <div> <%= t('mongoid.attributes.receipt.issuing_bank')%>: <%= receipt.issuing_bank %> </br> <%= t('mongoid.attributes.receipt.issuing_bank_branch')%>: <%= receipt.issuing_bank_branch %></div>
        <div><%= t('mongoid.attributes.receipt.issued_date')%>: <%= receipt.issued_date.present? ? receipt.issued_date.strftime("%d/%m/%Y") : "-" %></div>
        <div> <%= t('mongoid.attributes.receipt.processed_on')%>: <%= receipt.processed_on.present? ? l(receipt.processed_on) : "-" %></div>
      <% end %>
      <div> <%= t('mongoid.attributes.receipt.payment_mode')%> : <%= t("receipt.payment_mode.#{receipt.payment_mode}")%></div>
    </div>
  </td>
  <td data-title=<%= t('mongoid.attributes.receipt.token_number') %> ><%= receipt.try(:token_number) ? receipt.get_token_number : '--' %></td>
  <td data-title=<%= t('mongoid.attributes.receipt.status') %> ><%= t("mongoid.attributes.receipt/status.#{receipt.status}") %></td>
  <td data-title=<%= t('mongoid.attributes.receipt.total_amount') %> ><%= number_to_indian_currency(receipt.total_amount.round) %></td>
  <td>
    <div class="dropdown show text-right">
    <a class="btn dropdown-toggle table-dropdown-btn black-clr" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span></span><span></span><span></span></a>
      <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink">
        <%= link_to t('controller.receipts.print.link_name'), [current_user_role_group, receipt], target:"_blank", class: 'dropdown-item print-btn', data: { event_category: 'Section', event_action: 'Click', event_name: 'Print'} %>
        <% if policy([current_user_role_group, UserRequest::Cancellation.new(user_id: receipt.user_id, requestable: receipt)]).new? %>
          <%= link_to t('controller.user_requests.cancellation.new.link_name'), cancellation_link(receipt), class: "dropdown-item modal-remote-form-link" %>
        <% end %>
        <% if policy([current_user_role_group, receipt]).resend_success? %>
          <%= link_to t('controller.receipts.resend_email.link_name'), [:resend_success, current_user_role_group, receipt], class: 'dropdown-item' %>
        <% end %>
        <% if policy([:admin, Crm::Base.new()]).choose_crm? && Crm::Api.where(resource_class: 'Receipt').present? %>
          <%= link_to t('controller.crms.choose_crm.link_name'), choose_crm_admin_crm_base_index_path(resource_id: receipt.id, resource_class: receipt.class), class: "dropdown-item " %>
        <% end %>
        <% if policy([ current_user_role_group, receipt]).edit? %>
          <%= link_to t('controller.receipts.edit.link_name'), [:edit, current_user_role_group, receipt.user, receipt], class: 'dropdown-item modal-remote-form-link' %>
        <% end %>
        <% if policy([current_user_role_group, receipt]).edit_token_number? %>
          <%= link_to t('controller.receipts.edit_token_number.link_name'), [:edit_token_number, current_user_role_group, receipt], class: 'modal-remote-form-link dropdown-item' %>
        <% end %>
        <% if policy([current_user_role_group, Asset.new(assetable: receipt) ]).update? %>
          <%= link_to t('controller.assets.index.link_name'), assetables_path(assetable_type: receipt.class.model_name.i18n_key.to_s, assetable_id: receipt.id), class: 'dropdown-item modal-remote-form-link' %>
        <% end %>
     </div>
  </div>
  </td>
</tr>
