<% if @receipt.errors.present? %>
<div class="alert alert-danger">
  <ul>
    <% @receipt.errors.full_messages.each do |message| %>
    <li><%= message %></li>
    <% end %>
  </ul>
</div>
<% end %>
<% if current_user.role?('user') %>
  <%= form_for @receipt do |f| %>
    <%= f.text_field :total_amount, min: 0 %>
    <%= f.text_field :project_unit_id %>
    <%= f.submit :save, class: 'btn btn-primary' %>
  <% end %>
<% else %>
  <%= form_for [:admin, @user, @receipt], html: {id: 'receipt_form'} do |f| %>
    <div class="form-group">
      <%= f.label :payment_mode, class: 'control-label' %>
      <%= f.text_field :payment_mode, class: 'form-control', required: 'required', autofocus: true, disabled: (policy(@receipt).editable_field?("payment_mode") ? false : true) %>
    </div>
    <div class="form-group position-relative">
      <%= f.label :issued_date, class: 'control-label' %>
      <%= f.text_field :issued_date, class: 'form-control datepicker', required: 'required', "data-default-date": f.object.issued_date.present? ? f.object.issued_date.strftime("%d/%m/%Y") : '', "data-max-date": Date.today.strftime("%d/%m/%Y"), disabled: (policy(@receipt).editable_field?("issued_date") ? false : true), value: f.object.issued_date.present? ? f.object.issued_date.strftime("%d/%m/%Y") : "" %>
    </div>
    <div class="form-group">
      <%= f.label :issuing_bank, class: 'control-label' %>
      <%= f.text_field :issuing_bank, class: 'form-control', required: 'required', disabled: (policy(@receipt).editable_field?("issuing_bank") ? false : true) %>
    </div>
    <div class="form-group">
      <%= f.label :issuing_bank_branch, class: 'control-label' %>
      <%= f.text_field :issuing_bank_branch, class: 'form-control', required: 'required', disabled: (policy(@receipt).editable_field?("issuing_bank_branch") ? false : true) %>
    </div>
    <div class="form-group">
      <%= f.label :payment_identifier, class: 'control-label' %>
      <%= f.text_field :payment_identifier, class: 'form-control', required: 'required', disabled: (policy(@receipt).editable_field?("payment_identifier") ? false : true) %>
    </div>
    <div class="form-group">
      <%= f.label :total_amount, class: 'control-label' %>
      <%= f.text_field :total_amount, class: 'form-control', required: 'required', disabled: (policy(@receipt).editable_field?("total_amount") ? false : true) %>
      <%= f.hidden_field :payment_type, class: 'form-control', required: 'required', disabled: (policy(@receipt).editable_field?("payment_type") ? false : true) %>
    </div>
    <div class="form-group">
      <%= f.label :status, class: 'control-label' %>
      <%= f.select :status, Receipt.available_statuses.collect{|x| [x[:text], x[:id]]}, {prompt: true}, class: 'selectize', required: 'required', disabled: (policy(@receipt).editable_field?("status") ? false : true) %>
    </div>
    <%= f.submit :save, class: 'btn btn-primary' %>
  <% end %>
  <%= javascript_tag do %>
  $(document).ready(function(){
    FormInitializer.init($('#receipt_form'));
  });
  <% end %>
<% end %>
