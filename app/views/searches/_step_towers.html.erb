<%= render "form", {data: @data} %>
<div class="mt-3"></div>
<div class="row continuous-row">
  <% @units.each do |unit| %>
    <div class="col-4">
      <div class="card" data-jquery-selector="unit-card" data-unit-id="<%= unit.id %>">
        <div class="card-body">
          <div class="form-group">
            <%= unit.name %>
          </div>
          <div class="row">
            <div class="col-6">
              <div class="form-group">
                <label class="small">Carpet</label>
                <div><%= unit.carpet %></div>
              </div>
            </div>
            <div class="col-6">
              <div class="form-group">
                <label class="small">Status</label>
                <div><%= unit.status %></div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-6">
              <div class="form-group">
                <label class="small">Agreement</label>
                <div><%= unit.agreement_price %></div>
              </div>
            </div>
            <div class="col-6">
              <div class="form-group">
                <label class="small">All Inclusive</label>
                <div><%= unit.all_inclusive_price %></div>
              </div>
            </div>
          </div>
          <!-- GENERIC_TODO : implement image & other details here -->
        </div>
      </div>
    </div>
  <% end %>
</div>
<% if @search.next_step.present? %>
  <%= form_for [:user, @search], html: {class: 'validate-form', id: "edit_search_form"} do |f| %>
    <div class="form-group">
      <%= f.hidden_field :step, value: @search.next_step %>
      <%= f.hidden_field :project_unit_id %>
    </div>
    <div class="form-group">
      <%= f.submit "Next", class: "btn btn-primary float-left", disabled: 'disabled' %>
    </div>
  <% end %>
<% end %>
<% if @search.previous_step.present? %>
  <%= form_for [:user, @search], html: {class: 'validate-form'} do |f| %>
    <div class="form-group">
      <%= f.hidden_field :step, value: @search.previous_step %>
    </div>
    <div class="form-group">
      <%= f.submit "Previous", class: "btn btn-secondary float-right" %>
    </div>
  <% end %>
<% end %>
<%= javascript_tag do %>
  $(document).on('click', '[data-jquery-selector="unit-card"]', function(){
    var $form = $("#edit_search_form");
    $form.find('[name="search[project_unit_id]"]').val($(this).data("unit-id"));
    $form.find('input[type="submit"]').removeAttr("disabled");
  });
<% end %>
