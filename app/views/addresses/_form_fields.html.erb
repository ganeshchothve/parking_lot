<% random_id = "crs_#{11**11}" %>
<div class="row">
  <div class="col-md-6">
    <div class="form-group">
      <%= f.label :address1 %>
      <%= f.text_field :address1, class: 'form-control' %>
    </div>
  </div>
  <div class="col-md-6">
    <div class="form-group">
      <%= f.label :address2 %>
      <%= f.text_field :address2, class: 'form-control' %>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="form-group">
      <%= f.label :country %>
      <%= f.text_field :country, collection: [], prompt: :translate, input_html: { class: 'crs-country', data: { 'region-id' => random_id, 'default-value' => f.object.present? ? f.object.country : ""} }, class: 'form-control' %>
    </div>
  </div>

  <div class="col-md-6">
    <div class="form-group">
      <%= f.label :state %>
      <%= f.text_field :state, collection: [], prompt: :translate, input_html: { id: random_id, data: { 'default-value': f.object.present? ? f.object.state : "" } }, as: :select, class: 'form-control' %>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="form-group">
      <%= f.label :city %>
      <%= f.select :city, options_for_select((f.object.country == 'India' ? Address::CITY : [f.object.city]), f.object.try(:city) ? f.object.city : ''), {}, class: :selectize, data: {create: true} %>
    </div>
  </div>
  <div class="col-md-6">
    <div class="form-group">
      <%= f.label :zip %>
      <%= f.text_field :zip, class: 'form-control' %>
    </div>
  </div>
</div>


<%= javascript_tag do %>
  $(document).ready(function(){
    $("#channel_partner_address_attributes_country").on("change", function(){
      var $select = $("#channel_partner_address_attributes_city").selectize();
      var selectize = $select[0].selectize;
      selectize.setValue('');
      selectize.clearOptions();
      if($(this).val() == "India"){
        var cities = <%= raw Address::CITY.to_json %>
        var options = _.map(cities, function(d) { return { value: d, text: d } });
        selectize.addOption(options)
        selectize.refreshOptions(false);
      }
    });
  });
<% end %>

